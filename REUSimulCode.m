

V0 = 1;
R = 1000000;
L = 10^(-2);
C = 10^(-8);
I = @(f) V0./sqrt(R+(f*2*pi*L-1./(f*2*pi*C)).^2);

fe = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 16.2 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31];
Vpp = [62.04 121.33 183.67 246.00 312.56 376.64 444.85 514.81 584.70 651.17 712.22 771.14 822.65 860.93 887.67 901.17 902.44 901.56 893.73 877.02 853.52 827.12 798.88 769.35 740.16 705.2 684.84 657.37 631.34 606.87 586.38 563.46];

plot(fe,Vpp./R,fe,I(fe*1000),'Linewidth',2)
legend('ExpData','Simul')
xlim([2 30]);
ylim([-0.00001 0.0011]);
ylabel('Current (mA)');
xlabel('Frequency (KHz)');
title('Frequency-Current from Experiment and Simulation');
grid on
